<!DOCTYPE html>
<html>
<head>
  <title>Chat Luc√≠a</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  let nick = ""; // Variable para almacenar el nick del usuario

  function establecerNick() {
    nick = document.getElementById("nick").value;
    socket.emit('nick', nick);
    document.getElementById("nickForm").style.display = "none";
    document.getElementById("chatForm").style.display = "block";
  }

  socket.on('entradaUsuario', (msg) =>{
    console.log(msg);
  });

  function enviar(){
    const texto = document.getElementById("cajaTexto").value;
    const mensaje = nick + ": " + texto; // Mensaje incluyendo el nick
    socket.emit('mensaje', mensaje);
    mostrarMensaje("Yo: " + texto);
    document.getElementById("cajaTexto").value = "";
  }

  function mostrarMensaje(mensaje) {
    const mensajesElement = document.getElementById("mensajes");
    mensajesElement.innerHTML += "<p>" + mensaje + "</p>";
  }

  socket.on('mensaje', (datos) =>{
    mostrarMensaje(datos);
  });

  socket.on('entrada', (msg)=>{
    mostrarMensaje(msg);
  });

  // enviar emoji cuando se hace click
  function enviarEmoji(emojiSrc) {
    const emojiHTML = "<img class= 'chat-img' src='" + emojiSrc + "' alt='Emoji' style='width: 30px; height: 30px'>";
    const mensaje = nick + ": " + emojiHTML; // Mensaje incluyendo el nick y el emoji
    socket.emit('mensaje', mensaje);
    mostrarMensaje("Yo: " + emojiHTML);
  }
</script>

</head>

<body>
  <h1>Mi chat</h1>
  <div id="nickForm">
    <p>Por favor, introduce tu nick:</p>
    <input type="text" id="nick">
    <button onClick="establecerNick()">Enviar</button>
  </div>

  <div id="chatForm" style="display: none;">
    <input type="text" id="cajaTexto">
    <button onClick="enviar()">Enviar</button>

    <div id="mensajes"></div>

    <div>
      <ul>
        <!-- eventos al hacer click en los emoji -->
        <li class="emoji" onclick="enviarEmoji('./img/reir.png')"><img src="./img/reir.png" alt="Reir"></li>
        <li class="emoji" onclick="enviarEmoji('./img/omg.png')"><img src="./img/omg.png" alt="Omg"></li>
        <li class="emoji" onclick="enviarEmoji('./img/ira.png')"><img src="./img/ira.png" alt="Ira"></li>
      </ul>
    </div>
  </div>
</body>
</html>

<style>
  .emoji {
    list-style: none;
    display: inline-block;
    cursor: pointer;
  }

  .emoji img{
    width: 50px;
    height: 50px;
  }

  .chat-img{
    width: 30px; 
    height: 30px
  }
</style>
